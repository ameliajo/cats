import unittest
import sys
sys.path.append('../')
from gasket import *
 
class Test_GASKT(unittest.TestCase):
 
    def test1(self):

        t      = [i*0.1     for i in range(80)  ]
        betas  = [i*0.08    for i in range(15)  ]
        alphas = [i*0.1     for i in range(1,16)]
        X      = [i*0.0025  for i in range(1,68)]
        Q = [ 0.00049, 0.00098, 0.00191, 0.00338, 0.00485, 0.00721, 0.00966, \
            0.01245, 0.01588, 0.01931, 0.02353, 0.02794, 0.03260, 0.03799, \
            0.04338, 0.04884, 0.05433, 0.05994, 0.06622, 0.07249, 0.07971, \
            0.08755, 0.09539, 0.10324, 0.11108, 0.11730, 0.12050, 0.12158, \
            0.12081, 0.11662, 0.11015, 0.10426, 0.09838, 0.09403, 0.08995, \
            0.08616, 0.08302, 0.07988, 0.07745, 0.07526, 0.07313, 0.07129, \
            0.06945, 0.06783, 0.06634, 0.06484, 0.06327, 0.06171, 0.06016, \
            0.05863, 0.00000, 0.05588, 0.05467, 0.05356, 0.05258, 0.05160, \
            0.05055, 0.04949, 0.04840, 0.04726, 0.04613, 0.04502, 0.04392, \
            0.04299, 0.04256, 0.04213, 0.02471]
        Q5 = [ 0.33333, 0.66667 ]
        X5 = [ 0.205, 0.480 ]
        freeGasWgt = 0.0555556
        continWgt = 0.4444444
        oscWgt = 0.5
        T = 0.0255
        sab = gasket(X,Q,t,alphas,betas,T,continWgt,freeGasWgt,oscWgt,X5,Q5)
        correctSAB = [ 144.2350, 108.1537, 45.61302, 10.84460, 1.485720, \
        0.1538348, 4.898045E-2, 4.287713E-2, 4.115125E-2, 3.958769E-2, \
        3.808157E-2, 3.662962E-2, 3.523001E-2, 3.388099E-2, 4.404215E-23, \
        99.14718, 85.86089, 55.77489, 27.19705, 9.984122, 2.796914, 0.6425776, \
        0.1695090, 9.078054E-2, 7.871395E-2, 7.495747E-2, 7.205115E-2, \
        6.929756E-2, 6.664581E-2, 5.473704E-11, 78.71543, 71.51880, 53.65529, \
        33.25268, 17.04705, 7.260187, 2.607755, 0.8356927, 0.2879872, 0.1478283, \
        0.1158170, 0.1069983, 0.1023120, 9.833202E-2, 5.290365E-7, 66.29812, \
        61.69911, 49.74528, 34.75831, 21.06580, 11.09954, 5.116904, 2.103205, \
        0.8155352, 0.3443932, 0.1942371, 0.1502632, 0.1361476, 0.1292914, \
        4.913001E-5, 57.68125, 54.45734, 45.84583, 34.425, 23.07067, 13.82031, \
        7.427368, 3.614366, 1.631511, 0.7256932, 0.3590771, 0.2253441, 0.1791884, \
        0.1619442, 7.178845E-4, 51.22778, 48.82962, 42.30972, 33.33232, 23.88826, \
        15.59144, 9.290545, 5.082469, 2.586142, 1.261687, 0.629308, 0.3551993, \
        0.2452691, 0.2024133, 4.178715E-3, 46.14913, 44.28971, 39.17387, \
        31.93883, 24.01369, 16.66498, 10.69423, 6.370170, 3.551114, 1.885715, \
        0.9894563, 0.5474514, 0.3456893, 0.2585306, 1.441026E-2, 42.01135, \
        40.52473, 36.40106, 30.45169, 23.73418, 17.24746, 11.70280, 7.435252, \
        4.448433, 2.535263, 1.408260, 0.7948187, 0.4842789, 0.3362876, \
        3.588023E-2, 38.55278, 37.33569, 33.94115, 28.96783, 23.21854, 17.48877, \
        12.39377, 8.281892, 5.240427, 3.165439, 1.853693, 1.082138, 0.6578370, \
        0.4379781, 7.197417E-2, 35.60471, 34.58923, 31.74730, 27.53276, 22.56818, \
        17.49399, 12.83697, 8.933105, 5.914743, 3.748771, 2.299708, 1.392506, \
        0.8588903, 0.5623529, 0.1241933, 33.05265, 32.19211, 29.77955, 26.16673, \
        21.84528, 17.33634, 13.08961, 9.417275, 6.473057, 4.270978, 2.727727, \
        1.710741, 1.078373, 0.7057350, 0.1921661, 30.81565, 30.07683, 28.00481, \
        24.87729, 21.08855, 17.06700, 13.19679, 9.762179, 6.924002, 4.726639, \
        3.125831, 2.024742, 1.307427, 0.8632370, 0.2741029, 28.83457, 28.19315, \
        26.39589, 23.66546, 20.32236, 16.72204, 13.19349, 9.992657, 7.279078, \
        5.115833, 3.487272, 2.325654, 1.538343, 1.029701, 0.3673595, 27.06501, \
        26.50274, 24.93043, 22.52901, 19.56205, 16.32704, 13.10666, 10.12998, \
        7.550434, 5.441813, 3.809017, 2.607485, 1.764916, 1.200294, 0.4689299, \
        25.47285, 24.97576, 23.58993, 21.46409, 18.81723, 15.90028, 12.95707, \
        10.19195, 7.749732, 5.709487, 4.090562, 2.866555, 1.982458, 1.370822, \
        0.5758053]
        np.testing.assert_almost_equal(sab,correctSAB,4)
      


    
if __name__ == '__main__':
    unittest.main()
