import unittest
import sys
sys.path.append('../')
from acon2 import *
 
class Test_ACON(unittest.TestCase):
 
    def test1(self):

        #np.testing.assert_almost_equal( 5.61770521E-2,sterp(-0.01, betas, sLog),6)

        T = 0.0255
        SZCON = 144.9356 
        AM = 0.991409 
        W1 = 0.0555556 
        PSQ = 1.0
        NMAX = [0,0]
        X5 = [ 0.205, 0.48 ]
        ANK = [ 0.440454, 0.4966644, 0.01100791, 0.01241273, 1.375845E-4,\
        1.551430E-4, 1.146478E-6, 1.292791E-6, 7.165265E-9, 8.079691E-9,\
        3.582558E-11, 4.039761E-11, 1.492710E-13, 1.683209E-13, 5.331049E-16,\
        6.011393E-16, 1.665938E-18, 1.878544E-18, 4.627574E-21, 5.218142E-21]
        S2 = [ 1.4473E2, 1.0852E2, 4.5737E1, 1.0836E1, 1.4433, 1.0806E-1, \
        4.5479E-3, 1.0760E-4, 1.4311E-6, 1.0699E-8, 4.4968E-11, 1.0624E-13, \
        1.4110E-16, 1.0534E-19, 4.4212E-23, 1.0431E-26, 1.3834E-30, 1.0313E-34, \
        4.3224E-39, 1.0183E-43, 1.3486E-48, 1.0040E-53, 4.2019E-59, 9.8855E-65, \
        1.3073E-70, 9.7193E-77, 4.0618E-83, 9.5424E-90, 1.2602E-96, 9.3555-104, \
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ]
        EPS = [0.00204*i for i in range(100)]

        acon2(NMAX,X5,ANK,T,SZCON,EPS,AM,W1,PSQ,S2);
        correctS2 = [ 18.30396, 18.29063, 18.25073, 18.18441, 18.09196, 17.97380, \
        17.83042, 17.66245, 17.47060, 17.25569, 17.01862, 16.76039, 16.48206, \
        16.18476, 15.86970, 15.53813, 15.19135, 14.83070, 14.45754, 14.07326, \
        13.67927, 13.27695, 12.86772, 12.45295, 12.03402, 11.61225, 11.18897, \
        10.76542, 10.34284,  9.922386, 9.505173, 9.092252, 8.684614, 8.283181, \
        7.888808, 7.502279, 7.124307, 6.755533, 6.396526, 6.047785, 5.709737, \
        5.382741, 5.067088, 4.763004, 4.470654, 4.190142, 3.921517, 3.664772, \
        3.419853, 3.186658, 2.965044, 2.754827, 2.555790, 2.367684, 2.190230, \
        2.023128, 1.866055, 1.718673, 1.580628, 1.451555, 1.331083, 1.218833, \
        1.114425, 1.017478, 0.9276137, 0.8444552, 0.7676331, 0.6967843, \
        0.6315542, 0.5715977, 0.5165804, 0.4661792, 0.4200834, 0.3779947, \
        0.3396280, 0.3047115, 0.2729869, 0.2442094, 0.2181477, 0.1945836, \
        0.1733124, 0.1541418, 0.1368923, 0.1213962, 0.1074976, 9.505173E-2, \
        8.392453E-2, 7.399210E-2, 6.514024E-2, 5.726391E-2, 5.026668E-2, \
        4.406025E-2, 3.856394E-2, 3.370415E-2, 2.941392E-2, 2.563245E-2, \
        2.230462E-2, 1.938060E-2, 1.681540E-2, 1.456849E-2]

        np.testing.assert_almost_equal( S2,correctS2,5)

 


    
if __name__ == '__main__':
    unittest.main()
