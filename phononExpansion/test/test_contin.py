from helper import *
from getSAB_phononExpansion import *


class TestContin(unittest.TestCase):

    def test7(self):
        rho = [0.0, 0.0005, 0.001, 0.002, 0.0035, 0.005, 0.0075, 0.01, 0.013,\
        0.0165, 0.02, 0.0245, 0.029, 0.034, 0.0395, 0.045, 0.0506, 0.0562, 0.0622,\
        0.0686, 0.075, 0.083, 0.091, 0.099, 0.107, 0.115, 0.1197, 0.1214, 0.1218,\
        0.1195, 0.1125, 0.1065, 0.1005, 0.09542, 0.09126, 0.0871, 0.0839, 0.0807,\
        0.07798, 0.07574, 0.0735, 0.07162, 0.06974, 0.06804, 0.06652, 0.065, 0.0634,\
        0.0618, 0.06022, 0.05866, 0.0571, 0.05586, 0.05462, 0.0535, 0.0525, 0.0515,\
        0.05042, 0.04934, 0.04822, 0.04706, 0.0459, 0.04478, 0.04366, 0.04288,\
        0.04244, 0.042, 0.]
        nphon = 100
        nphon = 25
        tbeta = 0.444444
        tev = 2.5507297688e-2
        delta = 0.00255/tev
        alphas = [0.01, 0.08, 4.00, 6.00, 20.0, 50.0]
        betas  = [0.0, 0.4, 1.0, 5.0, 9.0, 20.0]
        alphas = [0.0253/tev * a for a in alphas]
        betas  = [0.0253/tev * b for b in betas]
        sab = getSAB_phononExpansion(nphon, delta, rho, alphas, betas, tbeta)
        sabCorrect = [5.6553448E-4, 2.9998239E-4, 3.5728611E-4, 1.3283598E-4, \
        7.2155584E-8, 7.038367E-16, 4.4601537E-3, 2.3709915E-3, 2.8246954E-3, \
        1.0657726E-3, 4.6129213E-6, 2.919488E-12, 1.0134916E-1, 6.0785511E-2, \
        7.3518778E-2, 5.1338891E-2, 9.9527483E-3, 2.6923598E-5, 1.0257124E-1, \
        6.5337140E-2, 7.9600320E-2, 6.9281786E-2, 1.9855721E-2, 1.4530853E-4, \
        2.6874094E-2, 2.4511956E-2, 3.1123242E-2, 6.6847691E-2, 6.6284139E-2, \
        1.1948925E-2, 1.0067245E-3, 1.2017244E-3, 1.5855351E-3, 6.8388574E-3, \
        1.7465674E-2, 4.3725435E-2]
        approxEqualVec(sab, sabCorrect, 1e-5)




if __name__ == '__main__':
    
    unittest.main()
